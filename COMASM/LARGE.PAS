{
Copyright 1990-2015, Jerome Shidel.

This project and related files are subject to the terms of the Mozilla Public License,
v. 2.0. If a copy of the MPL was not distributed with this file, You can obtain one at
http://mozilla.org/MPL/2.0/.
}

{$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S-,T-,V-,X+,Y+}
program MakeCOM;

  uses Dos, ComConst;

  procedure Com; assembler;
    { CS, DS, ES, SS are same as PSP }
    asm
      { PSP start--Note this part is not included in com file}
      @@Interupt20:          NOP; NOP;
      @@MemTop:              NOP; NOP;
      @@DosReservedArea01:   NOP;
      @@DosDispatcher:       NOP; NOP; NOP; NOP; NOP;
      @@SegAvail:            NOP; NOP;
      @@TerminateAddress:    NOP; NOP; NOP; NOP;
      @@ControlBreak:        NOP; NOP; NOP; NOP;
      @@CriticalError:       NOP; NOP; NOP; NOP;
      @@DosReservedArea02:   NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
      @@EnvSeg:              NOP; NOP;
      @@DosReservedArea03:   NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP;
      @@FormatedParamArea01: NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
      @@FormatedParamArea02: NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP;
      @@ParamString:         NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP; NOP; NOP; NOP; NOP;
                             NOP; NOP; NOP; NOP;
      { End of PSP }
        JMP @@Install

      { EGA Data Area }
      @@EGA_Video:       DW $0000, $0000
      @@EGA_Dynamic:     DW $0000, $0000
      @@EGA_Text:        DW $0000, $0000
      @@EGA_Graphics:    DW $0000, $0000
      @@VGA_Table:       DW $0000, $0000
      @@EGA_Reserved:    DW $0000, $0000,  $0000, $0000

      { VGA Data Area }
      @@VGA_TableSize:   DW  $0000       { Must me $001A }
      @@VGA_DCC:         DW  $0000,$0000
      @@VGA_Text:        DW  $0000,$0000
      @@VGA_Palette:     DW  $0000,$0000
      @@VGA_Reserved:    DW  $0000,$0000,  $0000,$0000,  $0000,$0000

      @@AuxiliaryFontTable:
        { Bytes per Character }  DB $10
        { RAM Block to Load   }  DB $00
        { Reserved            }  DB $00
      @@FontPointer:             DW $0000, $0000
        { Modes }                DB $03,$FF

      @@AuxiliaryFont:
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$7E,$81,$A5,$A5,$81,$81,$BD,$BD,$99,$81,$81,$7E,$00,$00
        DB $00,$00,$7E,$FF,$DB,$DB,$FF,$FF,$C3,$C3,$E7,$FF,$FF,$7E,$00,$00
        DB $00,$00,$00,$00,$00,$6C,$EE,$FE,$FE,$FE,$7C,$38,$10,$00,$00,$00
        DB $00,$00,$00,$00,$00,$10,$38,$7C,$FE,$7C,$38,$10,$00,$00,$00,$00
        DB $00,$00,$00,$00,$18,$3C,$3C,$DB,$FF,$DB,$18,$18,$18,$3C,$00,$00
        DB $00,$00,$00,$00,$18,$3C,$7E,$FF,$FF,$5A,$18,$18,$18,$3C,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$3C,$3C,$3C,$3C,$00,$00,$00,$00
        DB $00,$00,$FF,$FF,$FF,$FF,$FF,$FF,$C3,$C3,$C3,$C3,$FF,$FF,$FF,$FF
        DB $FF,$00,$00,$00,$00,$00,$00,$7E,$42,$42,$42,$42,$7E,$00,$00,$00
        DB $00,$00,$FF,$FF,$FF,$FF,$FF,$81,$BD,$BD,$BD,$BD,$81,$FF,$FF,$FF
        DB $FF,$00,$1E,$0E,$1A,$30,$78,$CC,$CC,$CC,$CC,$CC,$CC,$78,$00,$00
        DB $00,$00,$78,$CC,$CC,$CC,$CC,$CC,$CC,$78,$30,$FC,$30,$30,$00,$00
        DB $00,$00,$1F,$33,$33,$3F,$30,$30,$30,$30,$30,$70,$F0,$E0,$00,$00
        DB $00,$00,$3F,$63,$63,$7F,$63,$63,$63,$63,$63,$67,$E6,$C0,$00,$00
        DB $00,$00,$00,$00,$18,$DB,$DB,$3C,$E7,$3C,$DB,$DB,$18,$00,$00,$00
        DB $00,$00,$80,$C0,$E0,$F0,$F8,$FC,$FE,$FC,$F8,$F0,$E0,$C0,$80,$00
        DB $00,$00,$02,$06,$0E,$1E,$3E,$7E,$FE,$7E,$3E,$1E,$0E,$06,$02,$00
        DB $00,$00,$30,$78,$FC,$30,$30,$30,$30,$30,$FC,$78,$30,$00,$00,$00
        DB $00,$00,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$00,$CC,$CC,$00,$00
        DB $00,$00,$7F,$DB,$DB,$DB,$DB,$7B,$1B,$1B,$1B,$1B,$1B,$1B,$00,$00
        DB $00,$00,$3C,$66,$30,$7C,$C6,$C6,$C6,$C6,$7C,$18,$CC,$78,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$FE,$FE,$FE,$FE,$00
        DB $00,$00,$30,$78,$FC,$30,$30,$30,$30,$30,$FC,$78,$30,$FC,$00,$00
        DB $00,$00,$30,$78,$FC,$30,$30,$30,$30,$30,$30,$30,$30,$30,$00,$00
        DB $00,$00,$30,$30,$30,$30,$30,$30,$30,$30,$30,$FC,$78,$30,$00,$00
        DB $00,$00,$00,$00,$30,$18,$0C,$06,$FF,$06,$0C,$18,$30,$00,$00,$00
        DB $00,$00,$00,$00,$0C,$18,$30,$60,$FF,$60,$30,$18,$0C,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$C0,$C0,$C0,$C0,$FE,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$24,$42,$FF,$42,$24,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$10,$10,$38,$38,$7C,$7C,$FE,$FE,$00,$00,$00,$00
        DB $00,$00,$00,$00,$FE,$FE,$7C,$7C,$38,$38,$10,$10,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$18,$18,$18,$18,$18,$18,$18,$18,$18,$00,$18,$18,$00,$00
        DB $00,$00,$CC,$CC,$CC,$CC,$48,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$36,$6C,$6C,$FE,$6C,$6C,$6C,$FE,$6C,$6C,$D8,$00,$00
        DB $00,$00,$18,$18,$7E,$C6,$C0,$C0,$7C,$06,$06,$C6,$FC,$30,$30,$00
        DB $00,$00,$E6,$E6,$EC,$0C,$18,$18,$30,$30,$60,$6E,$CE,$CE,$00,$00
        DB $00,$00,$38,$6C,$6C,$6C,$38,$70,$DE,$CC,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$18,$18,$18,$18,$30,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$18,$30,$60,$60,$60,$60,$60,$60,$60,$60,$30,$18,$00,$00
        DB $00,$00,$60,$30,$18,$18,$18,$18,$18,$18,$18,$18,$30,$60,$00,$00
        DB $00,$00,$00,$00,$00,$66,$66,$3C,$FF,$3C,$66,$66,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$18,$18,$18,$7E,$18,$18,$18,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$30,$30,$30,$30,$60,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$7E,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$30,$30,$30,$00,$00
        DB $00,$00,$06,$06,$0C,$0C,$18,$18,$30,$30,$60,$60,$C0,$C0,$00,$00
        DB $00,$00,$7C,$C6,$CE,$CE,$DE,$DE,$F6,$F6,$E6,$E6,$C6,$7C,$00,$00
        DB $00,$00,$30,$70,$F0,$30,$30,$30,$30,$30,$30,$30,$30,$FC,$00,$00
        DB $00,$00,$7C,$C6,$C6,$06,$0C,$18,$30,$60,$C0,$C0,$C6,$FE,$00,$00
        DB $00,$00,$7C,$C6,$C6,$06,$06,$1C,$06,$06,$06,$C6,$C6,$7C,$00,$00
        DB $00,$00,$0C,$1C,$3C,$6C,$CC,$CC,$CC,$FE,$0C,$0C,$0C,$0C,$00,$00
        DB $00,$00,$FE,$C0,$C0,$C0,$C0,$FC,$06,$06,$06,$C6,$C6,$7C,$00,$00
        DB $00,$00,$3C,$66,$C0,$C0,$C0,$FC,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$FE,$C6,$C6,$06,$06,$0C,$18,$30,$30,$30,$30,$30,$00,$00
        DB $00,$00,$7C,$C6,$C6,$C6,$C6,$7C,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$7C,$C6,$C6,$C6,$C6,$7E,$06,$06,$06,$06,$CC,$78,$00,$00
        DB $00,$00,$00,$00,$00,$30,$30,$00,$00,$00,$30,$30,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$18,$18,$00,$00,$18,$18,$18,$18,$30,$00,$00
        DB $00,$00,$00,$06,$0C,$18,$30,$60,$C0,$60,$30,$18,$0C,$06,$00,$00
        DB $00,$00,$00,$00,$00,$00,$FE,$00,$00,$FE,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$C0,$60,$30,$18,$0C,$06,$0C,$18,$30,$60,$C0,$00,$00
        DB $00,$00,$7C,$C6,$06,$06,$0C,$18,$18,$18,$18,$00,$18,$18,$00,$00
        DB $00,$00,$00,$7C,$C6,$C6,$C6,$DE,$DE,$DE,$DC,$C0,$C0,$7C,$00,$00
        DB $00,$00,$7C,$C6,$C6,$C6,$C6,$C6,$FE,$C6,$C6,$C6,$C6,$C6,$00,$00
        DB $00,$00,$FC,$66,$66,$66,$66,$7C,$66,$66,$66,$66,$66,$FC,$00,$00
        DB $00,$00,$3E,$62,$C0,$C0,$C0,$C0,$C0,$C0,$C0,$C0,$62,$3E,$00,$00
        DB $00,$00,$F8,$6E,$66,$66,$66,$66,$66,$66,$66,$66,$6E,$F8,$00,$00
        DB $00,$00,$FE,$66,$60,$60,$60,$78,$60,$60,$60,$60,$66,$FE,$00,$00
        DB $00,$00,$FE,$66,$60,$60,$60,$78,$60,$60,$60,$60,$60,$F0,$00,$00
        DB $00,$00,$3E,$62,$C0,$C0,$C0,$C0,$DE,$C6,$C6,$C6,$66,$3E,$00,$00
        DB $00,$00,$C6,$C6,$C6,$C6,$C6,$FE,$C6,$C6,$C6,$C6,$C6,$C6,$00,$00
        DB $00,$00,$78,$30,$30,$30,$30,$30,$30,$30,$30,$30,$30,$78,$00,$00
        DB $00,$00,$1E,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$CC,$CC,$78,$00,$00
        DB $00,$00,$E6,$66,$66,$6C,$6C,$78,$78,$6C,$6C,$66,$66,$E6,$00,$00
        DB $00,$00,$F0,$60,$60,$60,$60,$60,$60,$60,$60,$66,$66,$FE,$00,$00
        DB $00,$00,$C6,$EE,$FE,$FE,$D6,$D6,$C6,$C6,$C6,$C6,$C6,$C6,$00,$00
        DB $00,$00,$C6,$C6,$E6,$E6,$F6,$FE,$DE,$DE,$CE,$CE,$C6,$C6,$00,$00
        DB $00,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$FC,$66,$66,$66,$66,$7C,$60,$60,$60,$60,$60,$E0,$00,$00
        DB $00,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$D6,$DE,$7C,$0E,$00
        DB $00,$00,$FC,$66,$66,$66,$66,$7C,$78,$6C,$66,$66,$66,$E6,$00,$00
        DB $00,$00,$7C,$C6,$C0,$C0,$60,$38,$0C,$06,$06,$06,$C6,$7C,$00,$00
        DB $00,$00,$FC,$B4,$30,$30,$30,$30,$30,$30,$30,$30,$30,$78,$00,$00
        DB $00,$00,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$38,$10,$00,$00
        DB $00,$00,$C6,$C6,$C6,$C6,$C6,$C6,$D6,$D6,$FE,$FE,$EE,$C6,$00,$00
        DB $00,$00,$C6,$C6,$C6,$C6,$6C,$38,$38,$6C,$C6,$C6,$C6,$C6,$00,$00
        DB $00,$00,$CC,$CC,$CC,$CC,$CC,$78,$30,$30,$30,$30,$30,$78,$00,$00
        DB $00,$00,$FE,$C6,$86,$06,$0C,$18,$30,$60,$C0,$C0,$C6,$FE,$00,$00
        DB $00,$00,$78,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$78,$00,$00
        DB $00,$00,$C0,$C0,$60,$60,$30,$30,$18,$18,$0C,$0C,$06,$06,$00,$00
        DB $00,$00,$78,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$78,$00,$00
        DB $00,$00,$10,$38,$6C,$C6,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$FF,$00
        DB $00,$00,$30,$30,$30,$30,$18,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$38,$0C,$0C,$7C,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$60,$60,$60,$60,$78,$6C,$66,$66,$66,$66,$66,$DC,$00,$00
        DB $00,$00,$00,$00,$00,$00,$7C,$C6,$C0,$C0,$C0,$C0,$C6,$7C,$00,$00
        DB $00,$00,$0C,$0C,$0C,$0C,$3C,$6C,$CC,$CC,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$00,$00,$00,$00,$7C,$C6,$C6,$FE,$C0,$C0,$C2,$7E,$00,$00
        DB $00,$00,$3C,$66,$60,$60,$60,$F8,$60,$60,$60,$60,$60,$E0,$00,$00
        DB $00,$00,$00,$00,$00,$00,$76,$CC,$CC,$CC,$CC,$CC,$CC,$7C,$0C,$CC
        DB $7C,$00,$E0,$60,$60,$60,$6C,$76,$66,$66,$66,$66,$66,$66,$00,$00
        DB $00,$00,$00,$18,$18,$00,$38,$18,$18,$18,$18,$18,$18,$1C,$00,$00
        DB $00,$00,$00,$0C,$0C,$00,$1C,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$CC,$CC
        DB $78,$00,$E0,$60,$60,$60,$66,$66,$6C,$78,$78,$6C,$66,$66,$00,$00
        DB $00,$00,$38,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$1C,$00,$00
        DB $00,$00,$00,$00,$00,$00,$CC,$EE,$FE,$D6,$D6,$D6,$C6,$C6,$00,$00
        DB $00,$00,$00,$00,$00,$00,$DC,$66,$66,$66,$66,$66,$66,$66,$00,$00
        DB $00,$00,$00,$00,$00,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$00,$00,$00,$00,$DC,$66,$66,$66,$66,$66,$66,$7C,$60,$60
        DB $E0,$00,$00,$00,$00,$00,$76,$CC,$CC,$CC,$CC,$CC,$CC,$7C,$0C,$0C
        DB $0E,$00,$00,$00,$00,$00,$DC,$76,$60,$60,$60,$60,$60,$60,$00,$00
        DB $00,$00,$00,$00,$00,$00,$7C,$C6,$60,$38,$0C,$06,$C6,$7C,$00,$00
        DB $00,$00,$10,$10,$30,$30,$7C,$30,$30,$30,$30,$30,$36,$1C,$00,$00
        DB $00,$00,$00,$00,$00,$00,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$00,$00,$00,$00,$CC,$CC,$CC,$CC,$CC,$CC,$78,$30,$00,$00
        DB $00,$00,$00,$00,$00,$00,$C6,$C6,$C6,$D6,$D6,$FE,$FE,$6C,$00,$00
        DB $00,$00,$00,$00,$00,$00,$C6,$6C,$6C,$38,$38,$6C,$6C,$C6,$00,$00
        DB $00,$00,$00,$00,$00,$00,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$7C,$0C,$CC
        DB $7C,$00,$00,$00,$00,$00,$FE,$86,$0C,$18,$30,$60,$C2,$FE,$00,$00
        DB $00,$00,$1C,$30,$30,$30,$30,$E0,$30,$30,$30,$30,$30,$1C,$00,$00
        DB $00,$00,$30,$30,$30,$30,$30,$00,$30,$30,$30,$30,$30,$30,$00,$00
        DB $00,$00,$E0,$30,$30,$30,$30,$1C,$30,$30,$30,$30,$30,$E0,$00,$00
        DB $00,$00,$00,$00,$76,$DC,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$10,$38,$6C,$C6,$C6,$C6,$C6,$C6,$C6,$FE,$00,$00,$00
        DB $00,$00,$3C,$66,$C0,$C0,$C0,$C0,$C0,$C0,$C0,$66,$3C,$0C,$66,$3C
        DB $00,$00,$00,$CC,$00,$00,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$0C,$18,$30,$00,$7C,$C6,$C6,$FE,$C0,$C0,$C2,$7E,$00,$00
        DB $00,$00,$38,$6C,$C6,$00,$38,$0C,$0C,$7C,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$00,$CC,$00,$00,$38,$0C,$0C,$7C,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$60,$30,$18,$00,$38,$0C,$0C,$7C,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$38,$6C,$38,$00,$38,$0C,$0C,$7C,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$00,$00,$00,$7C,$C6,$C0,$C0,$C0,$C6,$7C,$0C,$66,$3C,$00
        DB $00,$00,$38,$6C,$C6,$00,$7C,$C6,$C6,$FE,$C0,$C0,$C2,$7E,$00,$00
        DB $00,$00,$00,$C6,$00,$00,$7C,$C6,$C6,$FE,$C0,$C0,$C2,$7E,$00,$00
        DB $00,$00,$60,$30,$18,$00,$7C,$C6,$C6,$FE,$C0,$C0,$C2,$7E,$00,$00
        DB $00,$00,$00,$CC,$00,$00,$30,$30,$30,$30,$30,$30,$30,$78,$00,$00
        DB $00,$00,$30,$78,$CC,$00,$30,$30,$30,$30,$30,$30,$30,$78,$00,$00
        DB $00,$00,$C0,$60,$30,$00,$30,$30,$30,$30,$30,$30,$30,$78,$00,$00
        DB $00,$00,$00,$C6,$00,$00,$7C,$C6,$C6,$C6,$FE,$C6,$C6,$C6,$00,$00
        DB $00,$00,$38,$6C,$38,$00,$7C,$C6,$C6,$C6,$FE,$C6,$C6,$C6,$00,$00
        DB $00,$00,$1C,$38,$00,$7E,$66,$60,$78,$60,$60,$60,$66,$7E,$00,$00
        DB $00,$00,$00,$00,$00,$00,$6E,$3A,$1A,$7E,$D8,$D8,$DA,$6E,$00,$00
        DB $00,$00,$3E,$6C,$CC,$CC,$CC,$CE,$FC,$CC,$CC,$CC,$CC,$CE,$00,$00
        DB $00,$00,$38,$6C,$C6,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$00,$C6,$00,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$C0,$60,$30,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$30,$78,$CC,$00,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$C0,$60,$30,$00,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$00,$C6,$00,$00,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$7E,$06,$66
        DB $3E,$00,$C6,$00,$38,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$38,$00,$00
        DB $00,$00,$C6,$00,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$30,$30,$78,$CC,$C0,$C0,$C0,$C0,$CC,$78,$30,$30,$00,$00
        DB $00,$00,$38,$6C,$60,$60,$F0,$60,$60,$60,$60,$60,$E6,$FE,$00,$00
        DB $00,$00,$CC,$CC,$CC,$78,$30,$FC,$30,$30,$FC,$30,$30,$30,$00,$00
        DB $00,$00,$F8,$CC,$CC,$CC,$F8,$CC,$CC,$DE,$CC,$CC,$CC,$C6,$00,$00
        DB $00,$00,$0E,$1B,$1B,$18,$18,$18,$7E,$18,$18,$18,$18,$D8,$D8,$70
        DB $00,$00,$0C,$18,$30,$00,$38,$0C,$0C,$7C,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$0C,$18,$30,$00,$30,$30,$30,$30,$30,$30,$30,$78,$00,$00
        DB $00,$00,$06,$0C,$18,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$7C,$00,$00
        DB $00,$00,$0C,$18,$30,$00,$CC,$CC,$CC,$CC,$CC,$CC,$CC,$76,$00,$00
        DB $00,$00,$00,$76,$DC,$00,$DC,$66,$66,$66,$66,$66,$66,$66,$00,$00
        DB $00,$00,$76,$DC,$00,$C6,$E6,$F6,$FE,$DE,$CE,$C6,$C6,$C6,$00,$00
        DB $00,$00,$38,$0C,$7C,$CC,$CC,$76,$00,$FE,$00,$00,$00,$00,$00,$00
        DB $00,$00,$78,$CC,$CC,$CC,$CC,$78,$00,$FC,$00,$00,$00,$00,$00,$00
        DB $00,$00,$30,$30,$00,$30,$30,$30,$60,$C0,$C0,$C6,$C6,$7C,$00,$00
        DB $00,$00,$00,$00,$00,$00,$FE,$C0,$C0,$C0,$C0,$C0,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$FE,$06,$06,$06,$06,$06,$00,$00,$00,$00
        DB $00,$00,$C0,$C0,$C2,$C6,$CC,$18,$30,$60,$DC,$A6,$0C,$18,$3E,$00
        DB $00,$00,$C0,$C0,$C2,$C6,$CC,$18,$36,$6E,$DE,$B6,$7E,$06,$06,$00
        DB $00,$00,$30,$30,$00,$30,$30,$30,$30,$30,$30,$30,$30,$30,$00,$00
        DB $00,$00,$00,$00,$00,$1B,$36,$6C,$D8,$6C,$36,$1B,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$D8,$6C,$36,$1B,$36,$6C,$D8,$00,$00,$00,$00
        DB $00,$44,$11,$44,$11,$44,$11,$44,$11,$44,$11,$44,$11,$44,$11,$44
        DB $11,$AA,$55,$AA,$55,$AA,$55,$AA,$55,$AA,$55,$AA,$55,$AA,$55,$AA
        DB $55,$BB,$EE,$BB,$EE,$BB,$EE,$BB,$EE,$BB,$EE,$BB,$EE,$BB,$EE,$BB
        DB $EE,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18,$18
        DB $18,$18,$18,$18,$18,$18,$18,$18,$18,$F8,$18,$18,$18,$18,$18,$18
        DB $18,$18,$18,$18,$18,$18,$18,$F8,$18,$F8,$18,$18,$18,$18,$18,$18
        DB $18,$36,$36,$36,$36,$36,$36,$36,$36,$F6,$36,$36,$36,$36,$36,$36
        DB $36,$00,$00,$00,$00,$00,$00,$00,$00,$FE,$36,$36,$36,$36,$36,$36
        DB $36,$00,$00,$00,$00,$00,$00,$F8,$18,$F8,$18,$18,$18,$18,$18,$18
        DB $18,$36,$36,$36,$36,$36,$36,$F6,$06,$F6,$36,$36,$36,$36,$36,$36
        DB $36,$36,$36,$36,$36,$36,$36,$36,$36,$36,$36,$36,$36,$36,$36,$36
        DB $36,$00,$00,$00,$00,$00,$00,$FE,$06,$F6,$36,$36,$36,$36,$36,$36
        DB $36,$36,$36,$36,$36,$36,$36,$F6,$06,$FE,$00,$00,$00,$00,$00,$00
        DB $00,$36,$36,$36,$36,$36,$36,$36,$36,$FE,$00,$00,$00,$00,$00,$00
        DB $00,$18,$18,$18,$18,$18,$18,$F8,$18,$F8,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$F8,$18,$18,$18,$18,$18,$18
        DB $18,$18,$18,$18,$18,$18,$18,$18,$18,$1F,$00,$00,$00,$00,$00,$00
        DB $00,$18,$18,$18,$18,$18,$18,$18,$18,$FF,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$FF,$18,$18,$18,$18,$18,$18
        DB $18,$18,$18,$18,$18,$18,$18,$18,$18,$1F,$18,$18,$18,$18,$18,$18
        DB $18,$00,$00,$00,$00,$00,$00,$00,$00,$FF,$00,$00,$00,$00,$00,$00
        DB $00,$18,$18,$18,$18,$18,$18,$18,$18,$FF,$18,$18,$18,$18,$18,$18
        DB $18,$18,$18,$18,$18,$18,$18,$1F,$18,$1F,$18,$18,$18,$18,$18,$18
        DB $18,$36,$36,$36,$36,$36,$36,$36,$36,$37,$36,$36,$36,$36,$36,$36
        DB $36,$36,$36,$36,$36,$36,$36,$37,$30,$3F,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$3F,$30,$37,$36,$36,$36,$36,$36,$36
        DB $36,$36,$36,$36,$36,$36,$36,$F7,$00,$FF,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$FF,$00,$F7,$36,$36,$36,$36,$36,$36
        DB $36,$36,$36,$36,$36,$36,$36,$37,$30,$37,$36,$36,$36,$36,$36,$36
        DB $36,$00,$00,$00,$00,$00,$00,$FF,$00,$FF,$00,$00,$00,$00,$00,$00
        DB $00,$36,$36,$36,$36,$36,$36,$F7,$00,$F7,$36,$36,$36,$36,$36,$36
        DB $36,$18,$18,$18,$18,$18,$18,$FF,$00,$FF,$00,$00,$00,$00,$00,$00
        DB $00,$36,$36,$36,$36,$36,$36,$36,$36,$FF,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$FF,$00,$FF,$18,$18,$18,$18,$18,$18
        DB $18,$00,$00,$00,$00,$00,$00,$00,$00,$FF,$36,$36,$36,$36,$36,$36
        DB $36,$36,$36,$36,$36,$36,$36,$36,$36,$3F,$00,$00,$00,$00,$00,$00
        DB $00,$18,$18,$18,$18,$18,$18,$1F,$18,$1F,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$1F,$18,$1F,$18,$18,$18,$18,$18,$18
        DB $18,$00,$00,$00,$00,$00,$00,$00,$00,$3F,$36,$36,$36,$36,$36,$36
        DB $36,$36,$36,$36,$36,$36,$36,$36,$36,$FF,$36,$36,$36,$36,$36,$36
        DB $36,$18,$18,$18,$18,$18,$18,$FF,$18,$FF,$18,$18,$18,$18,$18,$18
        DB $18,$18,$18,$18,$18,$18,$18,$18,$18,$F8,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$1F,$18,$18,$18,$18,$18,$18
        DB $18,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
        DB $FF,$00,$00,$00,$00,$00,$00,$00,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$FF
        DB $FF,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0,$F0
        DB $F0,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F,$0F
        DB $0F,$FF,$FF,$FF,$FF,$FF,$FF,$FF,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$76,$DC,$D8,$D8,$D8,$D8,$DC,$76,$00,$00,$00
        DB $00,$00,$7C,$C6,$C6,$C6,$C6,$FC,$C6,$FC,$C0,$C0,$C0,$C0,$00,$00
        DB $00,$00,$FE,$C6,$C0,$C0,$C0,$C0,$C0,$C0,$C0,$C0,$C0,$C0,$00,$00
        DB $00,$00,$00,$00,$00,$FE,$6C,$6C,$6C,$6C,$6C,$6C,$6C,$EC,$00,$00
        DB $00,$00,$00,$FE,$C6,$C0,$60,$30,$18,$30,$60,$C0,$C6,$FE,$00,$00
        DB $00,$00,$00,$00,$00,$00,$7E,$CC,$CC,$CC,$CC,$CC,$CC,$78,$00,$00
        DB $00,$00,$00,$00,$00,$6C,$6C,$6C,$6C,$6C,$6C,$76,$60,$60,$C0,$00
        DB $00,$00,$00,$00,$00,$76,$DC,$D8,$18,$18,$18,$18,$18,$18,$00,$00
        DB $00,$00,$00,$00,$FC,$30,$78,$CC,$CC,$CC,$CC,$78,$30,$FC,$00,$00
        DB $00,$00,$00,$38,$7C,$C6,$C6,$C6,$FE,$C6,$C6,$C6,$7C,$38,$00,$00
        DB $00,$00,$38,$6C,$C6,$C6,$C6,$C6,$C6,$6C,$6C,$6C,$6C,$EE,$00,$00
        DB $00,$00,$1C,$30,$60,$30,$18,$7C,$CC,$CC,$CC,$CC,$CC,$78,$00,$00
        DB $00,$00,$00,$00,$00,$00,$7E,$D8,$D8,$D8,$D8,$7E,$00,$00,$00,$00
        DB $00,$00,$00,$06,$06,$0C,$7E,$DB,$DB,$DB,$DB,$7E,$30,$60,$60,$00
        DB $00,$00,$1C,$30,$60,$60,$60,$78,$60,$60,$60,$60,$30,$1C,$00,$00
        DB $00,$00,$7C,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$C6,$00,$00
        DB $00,$00,$00,$00,$00,$00,$FE,$00,$00,$FE,$00,$00,$FE,$00,$00,$00
        DB $00,$00,$00,$00,$00,$18,$18,$18,$7E,$18,$18,$18,$00,$7E,$00,$00
        DB $00,$00,$00,$60,$30,$18,$0C,$06,$0C,$18,$30,$60,$00,$FE,$00,$00
        DB $00,$00,$00,$0C,$18,$30,$60,$C0,$60,$30,$18,$0C,$00,$FE,$00,$00
        DB $00,$00,$00,$38,$6C,$6C,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60
        DB $60,$00,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$6C,$6C,$6C,$38
        DB $00,$00,$00,$00,$00,$00,$18,$18,$00,$7E,$00,$18,$18,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$76,$DC,$00,$76,$DC,$00,$00,$00,$00
        DB $00,$00,$38,$6C,$6C,$38,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$38,$38,$38,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$18,$18,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$0F,$0C,$0C,$0C,$0C,$0C,$0C,$0C,$CC,$CC,$6C,$6C,$3C
        DB $1C,$00,$DC,$66,$66,$66,$66,$66,$66,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$38,$6C,$0C,$18,$30,$64,$7C,$00,$00,$00,$00,$00,$00,$00
        DB $00,$00,$00,$00,$7C,$7C,$7C,$7C,$7C,$7C,$7C,$7C,$00,$00,$00,$00
        DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
        DB $00

      @@Keep: {All Code beyond this Label is lost.}
        CALL @@FreeENVSeg
        MOV DX, OFFSET @@KEEP
        MOV CX, DX
        AND CX, $0F
        SHR DX, 1
        SHR DX, 1
        SHR DX, 1
        SHR DX, 1
        CMP CX, 0
        JE  @@Keep2
        INC DX
      @@Keep2:
        MOV AX, $3100
        INT $21

      @@FreeENVSeg:
        PUSH ES
        PUSH AX
        MOV  ES, [$002C]
        MOV  AX, $4900
        INT  $21
        POP  AX
        POP  ES
        RET

      @@Install:

      @@Dulicate:
        { Duplicate SAVE_PTR Table }
        { Load Address of EGA_SavePtr }
        MOV  AX, $0000
        MOV  ES, AX
        { Load EGA Save pointer into DX:CX }
        MOV  CX, ES:[$04a8]
        MOV  DX, ES:[$04a8 + 2]
        { Move Save Pointer to ES:SI }
        MOV  SI, CX
        MOV  ES, DX
        MOV  CX, 12
        MOV  DI, Offset @@EGA_Video
        { Copy EGA Save Pointer Table }
      @@Duplicate2:
        MOV  AX, ES:[SI]
        MOV  CS:[DI], AX
        ADD  SI, 2
        ADD  DI, 2
        LOOP @@Duplicate2
        { Test for VGA }
      @@Test1:
        MOV  CX, CS:[OFFSET @@VGA_Table]
        MOV  DX, CS:[OFFSET @@VGA_Table + 2]
        CMP  CX, $0000
        JNE  @@Test2
        CMP  DX, $0000
        JNE  @@Test2
        MOV  DI, OFFSET @@NoVga
        CALL @@WriteString
        JMP @@Exit
        { Test Table Size }
      @@Test2:
        MOV  ES, DX
        MOV  SI, CX
        MOV  CX, ES:[SI]
        CMP  CX, $001A
        JE   @@Duplicate3
        MOV  DI, OFFSet @@InvalidVGA
        CALL @@WriteString
        JMP  @@Exit
      { Duplicate VGA Table }
      @@Duplicate3:
        MOV  DI, Offset @@VGA_TableSize
      @@Duplicate4:
        MOV  AL, ES:[SI]
        MOV  CS:[DI], AL
        INC  SI
        INC  DI
        LOOP @@Duplicate4
      @@UpdatePointers:
        { Load CS into DX }
        PUSH CS
        POP  DX
        { Set Aux font pointer }
        MOV  DI, OFFSET @@FontPointer
        MOV  CX, OFFSET @@AuxiliaryFont
        MOV  CS:[DI], CX     { Offset }
        MOV  CS:[DI + 2], DX { Segment }
        { Set Aux font table pointer }
        MOV  DI, OFFSET @@VGA_Text
        MOV  CX, OFFSET @@AuxiliaryFontTable
        MOV  CS:[DI], CX     { Offset }
        MOV  CS:[DI + 2], DX { Segment }
        { Set VGA Table Pointer }
        MOV  DI, OFFSET @@VGA_Table
        MOV  CX, OFFSET @@VGA_TableSize
        MOV  CS:[DI], CX     { Offset }
        MOV  CS:[DI + 2], DX { Segment }
        { Set EGA Save Pointer }
        MOV  AX, $0000
        MOV  ES, AX
        MOV  DI, $04A8
        MOV  CX, OFFSET @@EGA_Video
        MOV  ES:[DI], CX     { Offset }
        MOV  ES:[DI + 2], DX { Segment }

      @@ResetMode:
        MOV  AX, $0000
        MOV  ES, AX
        MOV  AL, ES:[$0449]
        MOV  AH, $0
        INT  $10
        MOV  DI, OFFSET @@Installed
        CALL @@WriteString
        JMP  @@Keep

      @@Exit:
        MOV AX, $4C00
        INT $21

      @@WriteString: { DS:DI := points to Null Terminated String }
        PUSH AX
        PUSH DX
        PUSH DI
      @@WriteString2:
        MOV  DL, [DI]
        INC  DI
        CMP  DL, 0
        JE   @@WriteString3
        MOV  AH, $02
        INT  $21
        JMP  @@WriteString2
      @@WriteString3:
        POP  DI
        POP  DX
        POP  AX
        RET

      @@NOVGA:
        DB 'Error:  VGA card not found.',13,10,0
      @@InvalidVGA:
        DB 'Error:  Unknown VGA table format.',13,10,0
      @@Installed:
        DB 'Large Text Font is now installed.',13,10,0
    end;

{$I COMASM.INC}

begin
  WriteLn ('Working...');
  CreateDriver( GetDriverName );
  WriteLn ( 'Finished.');
end.
